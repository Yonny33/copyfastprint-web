<!DOCTYPE html>
<html lang="es">
  <head>
    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-5Q94FLN3");
    </script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registro de Ventas y Clientes - COPYFAST&PRINT</title>
    <meta
      name="description"
      content="Panel de registro interno para clientes, ventas y control de cr√©dito de COPYFAST&PRINT."
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="/favicons/favicon-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/favicons/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicons/favicon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/favicons/android-icon-192x192.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/favicons/apple-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="/favicons/apple-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/favicons/apple-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/favicons/apple-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/favicons/apple-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/favicons/apple-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="/favicons/apple-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="/favicons/apple-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/favicons/apple-icon-180x180.png"
    />
    <link rel="manifest" href="/favicons/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta
      name="msapplication-TileImage"
      content="/favicons/ms-icon-144x144.png"
    />
    <meta name="theme-color" content="#ffffff" />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/formulario.css" />
    <link rel="stylesheet" href="css/especificaciones.css" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v6.1.1/css/all.css"
    />
  </head>
  <body>
    <!-- Verificaci√≥n de sesi√≥n -->
    <script>
      // Redirigir si no hay sesi√≥n activa
      if (sessionStorage.getItem("sesionActiva") !== "true") {
        window.location.href = "login-registro.html";
      }

      // Auto-logout despu√©s de 2 horas de inactividad
      let inactivityTimer;
      function resetTimer() {
        clearTimeout(inactivityTimer);
        inactivityTimer = setTimeout(() => {
          sessionStorage.clear();
          alert(
            "‚ö†Ô∏è Sesi√≥n expirada por inactividad. Por favor, inicia sesi√≥n nuevamente."
          );
          window.location.href = "login-registro.html";
        }, 2 * 60 * 60 * 1000); // 2 horas
      }

      // Detectar actividad del usuario
      document.addEventListener("mousemove", resetTimer);
      document.addEventListener("keypress", resetTimer);
      document.addEventListener("click", resetTimer);
      resetTimer();
    </script>

    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-5Q94FLN3"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div class="wrapper">
      <header>
        <nav class="navbar">
          <div class="brand">
            <h2>COPY<span>FAST&</span>PRINT</h2>
          </div>
          <ul class="menu" id="menu">
            <li><a href="admin.html">Admin</a></li>
            <li><a href="registro.html" class="active">Registro Ventas</a></li>
            <li><a href="gastos.html" >Gastos</a></li>
            <li>
              <a href="#" id="btnCerrarSesion" style="color: #c60e0f">
                <i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n
              </a>
            </li>
          </ul>
          <!-- ‚úÖ CORREGIDO: Clase "toggle_menu" en lugar de "toggle" -->
          <div class="toggle_menu">
            <i class="fas fa-bars" id="toggle_open"></i>
            <i class="fas fa-times" id="toggle_close"></i>
          </div>
        </nav>
      </header>

      <main>
        <section class="section-heading">
          <h2>Registro de <span>Cliente y Venta</span></h2>
          <div class="divider"></div>
          <p>
            <i class="fas fa-lock" style="color: #c60e0f"></i>
            <strong>Sistema Protegido</strong> - Introduce los detalles de la
            transacci√≥n. El sistema calcular√° autom√°ticamente el cr√©dito
            pendiente.
          </p>
        </section>

        <div class="form-container">
          <div class="form-wrapper">
            <form id="registro-ventas-form" class="cotizacion-form">
              <!-- SECCI√ìN 1: DATOS DEL CLIENTE -->
              <fieldset class="form-section">
                <legend>Datos del Cliente</legend>

                <div class="form-group">
                  <label for="cedula"
                    >C√©dula / ID (Identificador √önico) *</label
                  >
                  <input
                    type="text"
                    id="cedula"
                    name="cedula"
                    required
                    placeholder="N√∫mero de identificaci√≥n"
                  />
                  <p class="hint">
                    Ingresa el documento de identidad del cliente
                  </p>
                </div>

                <div class="form-group">
                  <label for="nombre">Nombre Completo *</label>
                  <input
                    type="text"
                    id="nombre"
                    name="nombre"
                    required
                    placeholder="Nombre o Raz√≥n Social"
                  />
                </div>

                <div class="form-group">
                  <label for="telefono">Tel√©fono / WhatsApp *</label>
                  <input
                    type="tel"
                    id="telefono"
                    name="telefono"
                    required
                    placeholder="+57 300 123 4567"
                  />
                </div>
              </fieldset>

              <!-- SECCI√ìN 2: DETALLES DE LA VENTA -->
              <fieldset class="form-section">
                <legend>Detalles de la Venta</legend>

                <div class="form-group">
                  <label for="descripcion"
                    >Producto / Descripci√≥n de la Venta *</label
                  >
                  <textarea
                    id="descripcion"
                    name="descripcion"
                    rows="4"
                    required
                    placeholder="Ej: 15 camisetas sublimadas, 50 copias a color, dise√±o personalizado, etc."
                  ></textarea>
                </div>

                <!-- Campo oculto para la divisa fija en VES -->
                <input type="hidden" name="divisa" value="VES" />

                <div class="form-group">
                  <label for="montoTotal"
                    >Monto Total de la Venta (Bs.) *</label
                  >
                  <input
                    type="number"
                    id="montoTotal"
                    name="montoTotal"
                    required
                    min="0.01"
                    step="0.01"
                    placeholder="500.00"
                  />
                  <p class="hint">
                    üáªüá™ Valor en <strong>Bol√≠vares Venezolanos (VES)</strong>
                  </p>
                </div>

                <div class="form-group">
                  <label for="montoPagado"
                    >Monto Pagado al Contado (Bs.) *</label
                  >
                  <input
                    type="number"
                    id="montoPagado"
                    name="montoPagado"
                    required
                    min="0"
                    step="0.01"
                    placeholder="200.00"
                    value="0"
                  />
                  <p class="hint">
                    Si pag√≥ en su totalidad, ingresa el mismo valor del monto
                    total
                  </p>
                </div>

                <div class="alert-box">
                  <i class="fas fa-info-circle"></i>
                  <div>
                    <h4>C√°lculo Autom√°tico de Cr√©dito</h4>
                    <p>
                      Si el <strong>Monto Pagado</strong> es menor al
                      <strong>Monto Total</strong>, la venta se registrar√°
                      autom√°ticamente como <strong>Cr√©dito Pendiente</strong>
                      y se calcular√° el saldo por cobrar.
                    </p>
                  </div>
                </div>
              </fieldset>

              <!-- BOTONES -->
              <div class="form-actions">
                <button type="submit" class="btn-submit">
                  <i class="fas fa-save"></i> Registrar Venta
                </button>
                <button type="reset" class="btn-reset">
                  <i class="fas fa-redo"></i> Limpiar Formulario
                </button>
              </div>
            </form>
          </div>

          <!-- SIDEBAR CON INFORMACI√ìN -->
          <div class="form-sidebar">
            <div class="info-box highlight">
              <h3><i class="fas fa-calculator"></i> Resumen de Cr√©dito</h3>
              <p>
                El sistema calcular√° autom√°ticamente en
                <strong>Bol√≠vares (VES)</strong>:
              </p>
              <ul class="tips-list">
                <li>Monto Total de la venta</li>
                <li>Monto Pagado (Inicial)</li>
                <li>Saldo Pendiente</li>
                <li>Estado del Cr√©dito</li>
              </ul>
            </div>

            <div class="info-box">
              <h3><i class="fas fa-flag"></i> Divisa</h3>
              <p>
                üáªüá™ Todas las transacciones se registran en
                <strong>Bol√≠vares Venezolanos (VES)</strong>
              </p>
            </div>

            <div class="info-box">
              <h3><i class="fas fa-shield-alt"></i> Seguridad</h3>
              <p>
                Los datos se almacenan de forma segura y solo son accesibles por
                personal autorizado de COPYFAST&PRINT.
              </p>
            </div>

            <div class="info-box">
              <h3><i class="fas fa-question-circle"></i> ¬øNecesitas ayuda?</h3>
              <p>
                Contacta al administrador del sistema si tienes dudas sobre el
                registro de ventas.
              </p>
              <a
                href="https://wa.me/+5804120766642"
                class="btn-small"
                target="_blank"
              >
                WhatsApp Soporte
              </a>
            </div>
          </div>
        </div>

        <!-- Loading Overlay -->
        <div
          id="loading-overlay"
          class="loading-overlay"
          style="
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(255, 255, 255, 0.95);
            z-index: 9999;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
          "
        >
          <div class="spinner"></div>
          <p style="margin-top: 1em; color: #666; font-weight: 600">
            Registrando venta...
          </p>
        </div>
      </main>

      <footer class="footer">
        <div class="footer-content">
          <h2>COPY<span>FAST&</span>PRINT</h2>
          <h5>Tu Soluci√≥n Integral en Impresi√≥n y Personalizaci√≥n</h5>
        </div>
        <!-- ‚úÖ CORREGIDO: Clase "social-networks" (antes era inconsistente) -->
        <div class="social-networks">
          <a href="https://www.instagram.com/copyfastprint/" target="_blank">
            <i class="fab fa-instagram"></i>
          </a>
          <a
            href="https://www.facebook.com/profile.php?id=61578120201237"
            target="_blank"
          >
            <i class="fab fa-facebook"></i>
          </a>
          <a href="https://co.pinterest.com/copyfastprint/" target="_blank">
            <i class="fab fa-pinterest"></i>
          </a>
          <a href="https://www.tiktok.com/@copyfastprint" target="_blank">
            <i class="fab fa-tiktok"></i>
          </a>
        </div>
      </footer>
    </div>

    <a href="#" id="scroll-to-top" class="scroll-to-top">
      <i class="fas fa-chevron-up"></i>
    </a>

    <script src="js/scripts.js"></script>
    <script src="js/registro-ventas.js"></script>
    <script>
      // Bot√≥n de cerrar sesi√≥n
      document
        .getElementById("btnCerrarSesion")
        .addEventListener("click", function (e) {
          e.preventDefault();
          if (confirm("¬øEst√°s seguro de que deseas cerrar sesi√≥n?")) {
            sessionStorage.clear();
            window.location.href = "login-registro.html";
          }
        });

      // Mostrar nombre del usuario logueado
      const usuario = sessionStorage.getItem("usuario");
      if (usuario) {
        const userInfo = document.createElement("div");
        userInfo.style.cssText =
          "position: fixed; bottom: 20px; right: 20px; background: #fff; padding: 1em; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 999;";
        userInfo.innerHTML = `
          <div style="display: flex; align-items: center; gap: 0.5em;">
            <i class="fas fa-user-circle" style="font-size: 1.5em; color: #c60e0f;"></i>
            <div>
              <strong style="display: block; color: #222;">Usuario:</strong>
              <span style="color: #666;">${usuario}</span>
            </div>
          </div>
        `;
        document.body.appendChild(userInfo);
      }
    </script>
  </body>
</html>
