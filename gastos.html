<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Control de Gastos - COPYFAST&PRINT</title>
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="/favicons/favicon-96x96.png"
    />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/formulario.css" />
    <link rel="stylesheet" href="css/especificaciones.css" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v6.1.1/css/all.css"
    />
  </head>
  <body>
    <div id="loading-overlay" class="loading-overlay" style="display: none">
      <div class="loader"></div>
      <p>Cargando datos...</p>
    </div>

    <script>
      if (sessionStorage.getItem("sesionActiva") !== "true") {
        window.location.href = "login-registro.html";
      }
    </script>

    <header>
      <nav class="navbar">
        <div class="brand">
          <h2>COPY<span>FAST&</span>PRINT</h2>
        </div>
        <ul class="menu" id="menu">
          <li><a href="admin.html">Admin</a></li>
          <li><a href="ventas.html">Registro Ventas</a></li>
          <li><a href="gastos.html">Control de Gastos</a></li>
          <li><a href="#" id="btnCerrarSesion">Cerrar SesiÃ³n</a></li>
        </ul>
        <div class="menu-toggle" id="menu_toggle">
          <i class="fas fa-bars" id="toggle_open"></i>
          <i class="fas fa-times" id="toggle_close" style="display: none"></i>
        </div>
      </nav>
    </header>

    <main class="admin-container">
      <div class="section-heading">
        <h2>ðŸ“Š Control de Gastos Diarios</h2>
        <p>Panel de administraciÃ³n y seguimiento de egresos.</p>
      </div>

      <section class="form-section">
        <h3>âž• Registrar Nuevo Gasto</h3>
        <form id="registro-gasto-form" class="form-grid">
          <div class="form-group">
            <label for="fecha">Fecha del Gasto *</label>
            <input type="date" id="fecha" name="fecha" required />
          </div>
          <div class="form-group">
            <label for="monto">Monto (Bs.) *</label>
            <input
              type="number"
              id="monto"
              name="monto"
              step="0.01"
              min="0.01"
              required
            />
          </div>
          <div class="form-group">
            <label for="categoria">CategorÃ­a *</label>
            <select id="categoria" name="categoria" required>
              <option value="">Selecciona una</option>
              <option value="Materiales">Materiales</option>
              <option value="Servicios">Servicios (Luz, Agua, Internet)</option>
              <option value="Mantenimiento">Mantenimiento</option>
              <option value="Transporte">Transporte / Flete</option>
              <option value="Nomina">NÃ³mina / Sueldos</option>
              <option value="Alquiler">Alquiler / Renta</option>
              <option value="Marketing">Marketing / Publicidad</option>
              <option value="Otros">Otros</option>
            </select>
          </div>
          <div class="form-group">
            <label for="metodoPago">MÃ©todo de Pago *</label>
            <select id="metodoPago" name="metodoPago" required>
              <option value="">Selecciona una</option>
              <option value="Efectivo">Efectivo</option>
              <option value="Transferencia">Transferencia</option>
              <option value="Pago-Movil">Pago MÃ³vil</option>
              <option value="Tarjeta">Tarjeta</option>
              <option value="Otro">Otro</option>
            </select>
          </div>
          <div class="form-group full-width">
            <label for="descripcion">DescripciÃ³n</label>
            <textarea id="descripcion" name="descripcion" rows="2"></textarea>
          </div>

          <button type="submit" class="calculate-btn full-width">
            <i class="fas fa-plus-circle"></i> Registrar Gasto
          </button>
        </form>
      </section>

      <section class="table-section">
        <h3>ðŸ“œ Detalle de Gastos</h3>
        <div id="error-container" style="color: red; margin-bottom: 15px"></div>
        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Monto (Bs.)</th>
                <th>CategorÃ­a</th>
                <th>DescripciÃ³n</th>
                <th>MÃ©todo de Pago</th>
              </tr>
            </thead>
            <tbody id="gastos-list"></tbody>
          </table>
        </div>
      </section>
    </main>

    <footer class="footer">
      <!-- ... tu footer ... -->
    </footer>

    <a href="#" id="scroll-to-top" class="scroll-to-top">
      <i class="fas fa-chevron-up"></i>
    </a>

    <!-- SCRIPTS CORREGIDOS -->
    <script src="public/js/scripts.js"></script>
    <script src="public/js/gasto-form-handler.js"></script>
    <script src="public/js/registro-gastos.js"></script>
    <script>
      // BotÃ³n de cerrar sesiÃ³n
      document
        .getElementById("btnCerrarSesion")
        .addEventListener("click", function (e) {
          e.preventDefault();
          if (confirm("Â¿EstÃ¡s seguro de que deseas cerrar sesiÃ³n?")) {
            sessionStorage.clear();
            window.location.href = "login-registro.html";
          }
        });
    </script>
  </body>
</html>
