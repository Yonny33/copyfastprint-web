<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Control de Gastos - COPYFAST&PRINT</title>
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="/favicons/favicon-96x96.png"
    />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/formulario.css" />
    <link rel="stylesheet" href="css/especificaciones.css" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v6.1.1/css/all.css"
    />
  </head>
  <body>
    <div id="loading-overlay" class="loading-overlay" style="display: none">
      <div class="loader"></div>
      <p>Cargando datos...</p>
    </div>

    <script>
      if (sessionStorage.getItem("sesionActiva") !== "true") {
        window.location.href = "login-registro.html";
      }
    </script>

    <header>
      <nav class="navbar">
        <div class="brand">
          <h2>COPY<span>FAST&</span>PRINT</h2>
        </div>
        <ul class="menu" id="menu">
          <li><a href="admin.html">Admin</a></li>
          <li><a href="ventas.html">Registro Ventas</a></li>
          <li><a href="gastos.html">Control de Gastos</a></li>
          <li><a href="#" id="btnCerrarSesion">Cerrar Sesi√≥n</a></li>
        </ul>
        <div class="menu-toggle" id="menu_toggle">
          <i class="fas fa-bars" id="toggle_open"></i>
          <i class="fas fa-times" id="toggle_close" style="display: none"></i>
        </div>
      </nav>
    </header>

    <main class="admin-container">
      <div class="section-heading">
        <h2>üìä Control de Gastos Diarios</h2>
        <p>
          Panel de administraci√≥n y seguimiento de egresos. Los datos que ves a
          continuaci√≥n corresponden al
          <strong>d√≠a actual</strong>.
        </p>
      </div>

      <div class="dashboard-grid">
        <div class="stat-card red">
          <i class="fas fa-money-bill-wave"></i>
          <div>
            <h4>Total Gastos (Hoy)</h4>
            <p class="stat-value" id="totalGastosDia">Bs. 0,00</p>
          </div>
        </div>
        <div class="stat-card dark-red">
          <i class="fas fa-list-alt"></i>
          <div>
            <h4>Cantidad de Gastos (Hoy)</h4>
            <p class="stat-value" id="cantidadGastos">0</p>
          </div>
        </div>
        <div class="stat-card gray">
          <i class="fas fa-calendar-alt"></i>
          <div>
            <h4>Total Gastos (Mes)</h4>
            <p class="stat-value" id="totalGastosMes">Bs. 0,00</p>
          </div>
        </div>
      </div>

      <section class="form-section">
        <h3>‚ûï Registrar Nuevo Gasto</h3>
        <form id="registro-gasto-form" class="form-grid">
          <div class="form-group">
            <label for="fecha">Fecha del Gasto *</label>
            <input type="date" id="fecha" name="fecha" required />
          </div>
          <div class="form-group">
            <label for="monto">Monto (Bs.) *</label>
            <input
              type="number"
              id="monto"
              name="monto"
              step="0.01"
              min="0.01"
              required
            />
          </div>
          <div class="form-group">
            <label for="categoria">Categor√≠a *</label>
            <select id="categoria" name="categoria" required>
              <option value="">Selecciona una</option>
              <option value="Materiales">Materiales</option>
              <option value="Servicios">Servicios (Luz, Agua, Internet)</option>
              <option value="Mantenimiento">Mantenimiento</option>
              <option value="Transporte">Transporte / Flete</option>
              <option value="Nomina">N√≥mina / Sueldos</option>
              <option value="Alquiler">Alquiler / Renta</option>
              <option value="Marketing">Marketing / Publicidad</option>
              <option value="Otros">Otros</option>
            </select>
          </div>
          <div class="form-group">
            <label for="metodoPago">M√©todo de Pago *</label>
            <select id="metodoPago" name="metodoPago" required>
              <option value="">Selecciona una</option>
              <option value="Efectivo">Efectivo</option>
              <option value="Transferencia">Transferencia</option>
              <option value="Pago-Movil">Pago M√≥vil</option>
              <option value="Tarjeta">Tarjeta</option>
              <option value="Otro">Otro</option>
            </select>
          </div>
          <div class="form-group">
            <label for="proveedor">Proveedor (Opcional)</label>
            <input type="text" id="proveedor" name="proveedor" />
          </div>
          <div class="form-group full-width">
            <label for="descripcion">Descripci√≥n *</label>
            <textarea
              id="descripcion"
              name="descripcion"
              rows="2"
              required
            ></textarea>
          </div>

          <button type="submit" class="calculate-btn full-width">
            <i class="fas fa-plus-circle"></i> Registrar Gasto
          </button>
        </form>
      </section>

      <section class="table-section">
        <h3>üìú Detalle de Gastos del D√≠a</h3>
        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Monto (Bs.)</th>
                <th>Categor√≠a</th>
                <th>Descripci√≥n</th>
                <th>M√©todo</th>
                <th>Proveedor</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody id="gastos-list"></tbody>
          </table>
        </div>
      </section>
    </main>

    <div id="edit-modal" class="modal">
      <div class="modal-content">
        <span class="modal-close" onclick="closeModal('edit-modal')"
          >&times;</span
        >
        <h3>‚úèÔ∏è Editar Gasto</h3>
        <form id="edit-gasto-form" class="form-grid">
          <input type="hidden" id="edit-gasto-id" name="id" />

          <div class="form-group">
            <label for="edit-fecha">Fecha del Gasto *</label>
            <input type="date" id="edit-fecha" name="fecha" required />
          </div>

          <div class="form-group">
            <label for="edit-monto">Monto (Bs.) *</label>
            <input
              type="number"
              id="edit-monto"
              name="monto"
              step="0.01"
              min="0.01"
              required
            />
          </div>

          <div class="form-group">
            <label for="edit-categoria">Categor√≠a *</label>
            <select id="edit-categoria" name="categoria" required>
              <option value="Materiales">Materiales</option>
              <option value="Servicios">Servicios (Luz, Agua, Internet)</option>
              <option value="Mantenimiento">Mantenimiento</option>
              <option value="Transporte">Transporte / Flete</option>
              <option value="Nomina">N√≥mina / Sueldos</option>
              <option value="Alquiler">Alquiler / Renta</option>
              <option value="Marketing">Marketing / Publicidad</option>
              <option value="Otros">Otros</option>
            </select>
          </div>

          <div class="form-group full-width">
            <label for="edit-descripcion">Descripci√≥n *</label>
            <textarea
              id="edit-descripcion"
              name="descripcion"
              rows="2"
              required
            ></textarea>
          </div>

          <div class="form-group">
            <label for="edit-metodoPago">M√©todo de Pago *</label>
            <select id="edit-metodoPago" name="metodo_pago" required>
              <option value="Efectivo">Efectivo</option>
              <option value="Transferencia">Transferencia</option>
              <option value="Pago-Movil">Pago M√≥vil</option>
              <option value="Tarjeta">Tarjeta</option>
              <option value="Otro">Otro</option>
            </select>
          </div>

          <div class="form-group">
            <label for="edit-proveedor">Proveedor (Opcional)</label>
            <input type="text" id="edit-proveedor" name="proveedor" />
          </div>

          <button type="submit" class="calculate-btn">
            <i class="fas fa-save"></i> Guardar Cambios
          </button>
        </form>
      </div>
    </div>

    <style>
      .modal {
        display: none; /* Oculto por defecto */
        position: fixed;
        z-index: 2000; /* Asegura que est√© por encima de todo */
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
        padding-top: 60px;
      }
      .modal-content {
        background-color: #fefefe;
        margin: 5% auto; /* 5% desde arriba y centrado */
        padding: 30px;
        border: 1px solid #888;
        width: 90%;
        max-width: 500px;
        border-radius: 12px;
        position: relative;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }
      .modal-close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        line-height: 1;
        cursor: pointer;
        position: absolute;
        top: 10px;
        right: 20px;
      }
      .modal-close:hover,
      .modal-close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
      }
    </style>

    <footer class="footer">
      <div class="footer-content">
        <h2>COPY<span>FAST&</span>PRINT</h2>
        <h5>Tu Soluci√≥n Integral en Impresi√≥n y Personalizaci√≥n</h5>
      </div>
      <div class="social-networks">
        <a href="https://www.instagram.com/copyfastprint/" target="_blank"
          ><i class="fab fa-instagram"></i
        ></a>
        <a
          href="https://www.facebook.com/profile.php?id=61578120201237"
          target="_blank"
          ><i class="fab fa-facebook"></i
        ></a>
        <a href="https://co.pinterest.com/copyfastprint/" target="_blank"
          ><i class="fab fa-pinterest"></i
        ></a>
        <a href="https://www.tiktok.com/@copyfastprint" target="_blank"
          ><i class="fab fa-tiktok"></i
        ></a>
      </div>
    </footer>

    <a href="#" id="scroll-to-top" class="scroll-to-top">
      <i class="fas fa-chevron-up"></i>
    </a>

    <script src="js/scripts.js"></script>
    <script src="js/registro-gastos.js"></script>
    <script src="js/gasto-form-handler.js"></script>
    <script>
      // Bot√≥n de cerrar sesi√≥n
      document
        .getElementById("btnCerrarSesion")
        .addEventListener("click", function (e) {
          e.preventDefault();
          if (confirm("¬øEst√°s seguro de que deseas cerrar sesi√≥n?")) {
            sessionStorage.clear();
            window.location.href = "login-registro.html";
          }
        });
    </script>
  </body>
</html>
