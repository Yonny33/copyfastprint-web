<!DOCTYPE html>
<html lang="es">
  <head>
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-5Q94FLN3");
    </script>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registro de Ventas - COPYFAST&PRINT</title>
    <meta
      name="description"
      content="Panel de registro interno para ventas y control de cr茅dito de COPYFAST&PRINT."
    />
    <link rel="icon" type="image/png" sizes="96x96" href="/favicons/favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />
    <link rel="stylesheet" href="/css/main.css" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v6.1.1/css/all.css"
    />
  </head>
  <body>
    <div id="loading-overlay" class="loading-overlay" style="display: none">
      <div class="loader"></div>
      <p>Registrando venta...</p>
    </div>

    <script>
      if (sessionStorage.getItem("sesionActiva") !== "true") {
        window.location.href = "login-registro.html";
      }
    </script>

    <header>
      <nav class="navbar">
        <div class="brand">
          <h2>COPY<span>FAST&</span>PRINT</h2>
        </div>
        <ul class="menu" id="menu">
          <li><a href="admin.html">Admin</a></li>
          <li><a href="ventas.html" class="active">Registro Ventas</a></li>
          <li><a href="clientes.html">Registro Clientes</a></li>
          <li><a href="registro-gastos.html">Registro Gastos</a></li>
          <li><a href="reportes.html"><i class="fas fa-chart-line"> </i>Reportes</a></li>
          <li><a href="#" id="btnCerrarSesion">Cerrar Sesi贸n</a></li>
        </ul>
        <div class="menu-toggle" id="menu_toggle">
          <i class="fas fa-bars" id="toggle_open"></i>
          <i class="fas fa-times" id="toggle_close" style="display: none"></i>
        </div>
      </nav>
    </header>

    <div class="container main-content">
      <div class="form-wrapper">
        <section class="form-section">
          <div class="section-heading">
            <h2> Registro de Venta</h2>
            <p>
              Completa los datos para registrar una nueva venta. Los c谩lculos se hacen autom谩ticamente.
            </p>
          </div>

          <form id="registro-ventas-form" class="form-grid">
            
            <div class="form-separator full-width">
              <h3><i class="fas fa-receipt"></i> Detalle de la Venta</h3>
            </div>

            <div class="form-group">
              <label for="fecha">Fecha *</label>
              <input type="date" id="fecha" name="fecha" required />
            </div>

            <div class="form-group">
              <label for="cliente">Cliente *</label>
              <select id="cliente" name="cliente" required>
                <option value="">Cargando clientes...</option>
              </select>
               <input type="hidden" id="id_cliente" name="id_cliente" />
            </div>
            
            <div class="form-group full-width">
              <label for="descripcion">Descripci贸n del Servicio/Producto *</label>
              <textarea id="descripcion" name="descripcion" rows="2" required></textarea>
            </div>

            <div class="form-group">
              <label for="cantidad">Cantidad *</label>
              <input type="number" id="cantidad" name="cantidad" min="1" step="1" value="1" required />
            </div>

            <div class="form-group">
              <label for="precio_unitario">Precio Unitario (Bs.) *</label>
              <input type="number" id="precio_unitario" name="precio_unitario" step="0.01" min="0.01" required />
            </div>

            <div class="form-group">
                <label for="venta_bruta">Venta Bruta (Bs.)</label>
                <input type="number" id="venta_bruta" name="venta_bruta" readonly />
            </div>

            <div class="form-group">
              <label for="abono_recibido">Abono Recibido (Bs.) *</label>
              <input type="number" id="abono_recibido" name="abono_recibido" step="0.01" min="0" required />
            </div>

            <div class="form-group">
              <label for="saldo_pendiente">Saldo Pendiente (Bs.)</label>
              <input type="number" id="saldo_pendiente" name="saldo_pendiente" readonly />
            </div>

            <div class="form-group">
              <label for="metodo_pago">M茅todo de Pago *</label>
              <select id="metodo_pago" name="metodo_pago" required>
                <option value="">Selecciona uno</option>
                <option value="Efectivo">Efectivo</option>
                <option value="Transferencia">Transferencia</option>
                <option value="Pago-Movil">Pago M贸vil</option>
                <option value="Tarjeta">Tarjeta</option>
                <option value="Credito">Cr茅dito</option>
                <option value="Otro">Otro</option>
              </select>
            </div>
            
            <div class="form-group full-width">
              <button type="submit" class="calculate-btn">
                <i class="fas fa-save"></i> Registrar Venta
              </button>
              <button type="reset" class="btn-secondary">
                <i class="fas fa-trash-alt"></i> Limpiar Formulario
              </button>
            </div>
          </form>
        </section>
      </div>

      <div class="info-column">
        <div class="info-box highlight">
          <h3><i class="fas fa-calculator"></i> C谩lculos Autom谩ticos</h3>
          <p>
            La <strong>Venta Bruta</strong> y el <strong>Saldo Pendiente</strong> se calculan solos para evitar errores.
          </p>
        </div>
        <div class="info-box info">
          <h3><i class="fas fa-check"></i> Campos Requeridos</h3>
          <p>
            Los campos marcados con (*) son obligatorios.
          </p>
        </div>
      </div>
    </div>

    <footer class="footer">
      <div class="footer-content">
        <h2>COPY<span>FAST&</span>PRINT</h2>
        <h5>Tu Soluci贸n Integral en Impresi贸n y Personalizaci贸n</h5>
      </div>
      <div class="social-networks">
        <a href="https://www.instagram.com/copyfastprint/" target="_blank"
          ><i class="fab fa-instagram"></i
        ></a>
        <a
          href="https://www.facebook.com/profile.php?id=61578120201237"
          target="_blank"
          ><i class="fab fa-facebook"></i
        ></a>
        <a href="https://co.pinterest.com/copyfastprint/" target="_blank"
          ><i class="fab fa-pinterest"></i
        ></a>
        <a href="https://www.tiktok.com/@copyfastprint" target="_blank"
          ><i class="fab fa-tiktok"></i
        ></a>
      </div>
    </footer>

    <a href="#" id="scroll-to-top" class="scroll-to-top">
      <i class="fas fa-chevron-up"></i>
    </a>

    <script src="/js/scripts.js"></script>
    <script src="/js/registro-ventas.js"></script>
    <script>
      document.getElementById("btnCerrarSesion").addEventListener("click", function (e) {
          e.preventDefault();
          if (confirm("驴Est谩s seguro de que deseas cerrar sesi贸n?")) {
            sessionStorage.clear();
            window.location.href = "login-registro.html";
          }
      });

      const usuario = sessionStorage.getItem("usuario");
      if (usuario) {
        const userInfo = document.createElement("div");
        userInfo.style.cssText =
          "position: fixed; bottom: 20px; right: 20px; background: #fff; padding: 1em; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 999;";
        userInfo.innerHTML = `
          <div style='''display: flex; align-items: center; gap: 0.5em;'''>
            <i class='''fas fa-user-circle''' style='''font-size: 1.5em; color: #c60e0f;'''></i>
            <div>
              <strong style='''display: block; color: #333;'''>Usuario: ${usuario}</strong>
              <small style='''color: #666;'''>Sesi贸n iniciada</small>
            </div>
          </div>
        `;
        document.body.appendChild(userInfo);
      }
    </script>
  </body>
</html>
