<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solicitar Cotización - Copy Fast & Print</title>
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="/favicons/favicon-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/favicons/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicons/favicon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/favicons/android-icon-192x192.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/favicons/apple-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="/favicons/apple-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/favicons/apple-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/favicons/apple-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/favicons/apple-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/favicons/apple-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="/favicons/apple-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="/favicons/apple-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/favicons/apple-icon-180x180.png"
    />
    <link rel="manifest" href="/favicons/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta
      name="msapplication-TileImage"
      content="/favicons/ms-icon-144x144.png"
    />
    <meta name="theme-color" content="#ffffff" />

    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/formulario.css" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v6.1.1/css/all.css"
    />
  </head>
  <body>
    <header>
      <nav class="navbar">
        <div class="brand">
          <h2>COPY<span>FAST&</span>PRINT</h2>
        </div>
        <ul class="menu" id="menu">
          <li><a href="index.html">Inicio</a></li>
          <li><a href="diseño.html">Diseños</a></li>
          <li><a href="acercade.html">Acerca de</a></li>
          <li><a href="formulario.html" class="active">Cotización</a></li>
          <li><a href="especificaciones.html">¿Como Funciona?</a></li>
        </ul>
        <div class="toggle_menu">
          <i class="fas fa-bars" id="toggle_open"></i>
          <i class="fas fa-times" id="toggle_close"></i>
        </div>
      </nav>
    </header>

    <main>
      <section class="section-heading">
        <h2>Solicita tu <span>Cotización</span></h2>
        <div class="divider"></div>
        <p>
          Completa el formulario y nos pondremos en contacto dentro de 24 horas
        </p>
      </section>

      <div class="form-container">
        <div class="form-wrapper">
          <!-- FORMULARIO CON NETLIFY FORMS -->
          <form
            name="cotizacion"
            method="POST"
            data-netlify="true"
            netlify-honeypot="bot-field"
            class="cotizacion-form"
          >
            <!-- Campo oculto para Netlify -->
            <input type="hidden" name="form-name" value="cotizacion" />

            <!-- Honeypot anti-spam -->
            <p style="display: none">
              <label
                >No llenes esto si eres humano: <input name="bot-field"
              /></label>
            </p>

            <!-- SECCIÓN 1: INFORMACIÓN PERSONAL -->
            <fieldset class="form-section">
              <legend>Tu Información</legend>

              <div class="form-group">
                <label for="nombre">Nombre Completo *</label>
                <input
                  type="text"
                  id="nombre"
                  name="nombre"
                  placeholder="Juan Pérez"
                  required
                />
              </div>

              <div class="form-group">
                <label for="email">Email *</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  placeholder="correo@ejemplo.com"
                  required
                />
              </div>

              <div class="form-group">
                <label for="telefono">Teléfono / WhatsApp *</label>
                <input
                  type="tel"
                  id="telefono"
                  name="telefono"
                  placeholder="+58 412-0766642"
                  required
                />
              </div>

              <div class="form-group">
                <label for="empresa">Empresa / Emprendimiento (Opcional)</label>
                <input
                  type="text"
                  id="empresa"
                  name="empresa"
                  placeholder="Mi Negocio SAS"
                />
              </div>
            </fieldset>

            <!-- SECCIÓN 2: TIPO DE SERVICIO -->
            <fieldset class="form-section">
              <legend>Tipo de Servicio</legend>

              <div class="form-group radio-group">
                <label class="radio-label">
                  <input type="radio" name="servicio" value="dtf" required />
                  <span class="radio-custom">
                    <i class="fas fa-circle"></i>
                  </span>
                  DTF (Direct-to-Film)
                </label>
                <p class="option-desc">
                  Ideal para camisetas de color, diseños detallados
                </p>
              </div>

              <div class="form-group radio-group">
                <label class="radio-label">
                  <input
                    type="radio"
                    name="servicio"
                    value="sublimacion"
                    required
                  />
                  <span class="radio-custom">
                    <i class="fas fa-circle"></i>
                  </span>
                  Sublimación
                </label>
                <p class="option-desc">
                  Ideal para tazas, mousepads, fotos, diseños vibrantes
                </p>
              </div>

              <div class="form-group radio-group">
                <label class="radio-label">
                  <input type="radio" name="servicio" value="ambos" required />
                  <span class="radio-custom">
                    <i class="fas fa-circle"></i>
                  </span>
                  Ambos servicios
                </label>
                <p class="option-desc">
                  Aún no sé cuál es mejor para mi proyecto
                </p>
              </div>
            </fieldset>

            <!-- SECCIÓN 3: DETALLES DEL PROYECTO -->
            <fieldset class="form-section">
              <legend>Detalles del Proyecto</legend>

              <div class="form-group" id="prendasDTF" style="display: none">
                <label for="prendaDTF">¿Qué prenda deseas?</label>
                <select id="prendaDTF" name="prendaDTF">
                  <option value="">-- Selecciona una opción --</option>
                  <option value="camiseta">Camiseta</option>
                  <option value="sudadera">Sudadera</option>
                  <option value="gorra">Gorra</option>
                  <option value="otra">Otra prenda</option>
                </select>
              </div>

              <div
                class="form-group"
                id="prendasSublimacion"
                style="display: none"
              >
                <label for="prendaSublimacion">¿Qué producto deseas?</label>
                <select id="prendaSublimacion" name="prendaSublimacion">
                  <option value="">-- Selecciona una opción --</option>
                  <option value="taza">Taza</option>
                  <option value="mousepad">Mousepad</option>
                  <option value="cojin">Cojín</option>
                  <option value="camiseta-blanca">Camiseta Blanca</option>
                  <option value="otro">Otro producto</option>
                </select>
              </div>

              <div class="form-group">
                <label for="cantidad">Cantidad de Unidades *</label>
                <input
                  type="number"
                  id="cantidad"
                  name="cantidad"
                  placeholder="1"
                  min="1"
                  required
                />
                <p class="hint">Ingresa la cantidad total que necesitas</p>
              </div>

              <div class="form-group">
                <label for="descripcion">Descripción del Proyecto *</label>
                <textarea
                  id="descripcion"
                  name="descripcion"
                  placeholder="Describe tu proyecto, ideas, colores, etc."
                  rows="4"
                  required
                ></textarea>
              </div>

              <div class="form-group">
                <label for="archivo">Adjunta tu diseño (Opcional)</label>
                <input
                  type="file"
                  id="archivo"
                  name="archivo"
                  accept=".png,.jpg,.jpeg,.pdf"
                />
                <p class="hint">PNG, JPG, PDF (Máx. 10MB)</p>
              </div>
            </fieldset>

            <!-- SECCIÓN 4: PRESUPUESTO -->
            <fieldset class="form-section">
              <legend>Presupuesto Estimado</legend>

              <div class="form-group">
                <label for="presupuesto"
                  >¿Cuál es tu rango de presupuesto? *</label
                >
                <select id="presupuesto" name="presupuesto" required>
                  <option value="">-- Selecciona un rango --</option>
                  <option value="menor-50k">Menor a $50.000</option>
                  <option value="50k-100k">$50.000 - $100.000</option>
                  <option value="100k-250k">$100.000 - $250.000</option>
                  <option value="250k-500k">$250.000 - $500.000</option>
                  <option value="mayor-500k">Mayor a $500.000</option>
                  <option value="no-se">No sé, asesoradme</option>
                </select>
              </div>

              <div class="form-group">
                <label for="fechaRequerida">¿Para cuándo lo necesitas? *</label>
                <input
                  type="date"
                  id="fechaRequerida"
                  name="fechaRequerida"
                  required
                />
              </div>
            </fieldset>

            <!-- SECCIÓN 5: MENSAJE ADICIONAL -->
            <fieldset class="form-section">
              <legend>Información Adicional</legend>

              <div class="form-group">
                <label for="mensaje">¿Hay algo más que debamos saber?</label>
                <textarea
                  id="mensaje"
                  name="mensaje"
                  placeholder="Especificaciones adicionales, preferencias, etc."
                  rows="3"
                ></textarea>
              </div>

              <div class="form-group checkbox-group">
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="terminos"
                    value="aceptado"
                    required
                  />
                  <span class="checkbox-custom">
                    <i class="fas fa-check"></i>
                  </span>
                  Acepto los términos y condiciones
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="newsletter" value="si" />
                  <span class="checkbox-custom">
                    <i class="fas fa-check"></i>
                  </span>
                  Deseo recibir ofertas y novedades
                </label>
              </div>
            </fieldset>

            <!-- BOTONES -->
            <div class="form-actions">
              <button type="submit" class="btn-submit">
                <i class="fas fa-paper-plane"></i> Enviar Cotización
              </button>
              <button type="reset" class="btn-reset">
                <i class="fas fa-redo"></i> Limpiar Formulario
              </button>
            </div>
          </form>
        </div>

        <!-- SIDEBAR CON INFORMACIÓN -->
        <div class="form-sidebar">
          <div class="info-box">
            <h3><i class="fas fa-clock"></i> Tiempo de Respuesta</h3>
            <p>Nos comprometemos a responder dentro de 24 horas</p>
          </div>

          <div class="info-box">
            <h3><i class="fas fa-headset"></i> Soporte</h3>
            <p>¿Dudas? Contáctanos por WhatsApp</p>
            <a
              href="https://wa.me/+5804120766642"
              class="btn-small"
              target="_blank"
            >
              Chatear
            </a>
          </div>
          <!-- SIDEBAR CON INFORMACIÓN -->
          <div class="currency-calculator">
            <div class="calculator-header">
              <i class="fas fa-calculator"></i>
              <h3>Calculadora de Divisas</h3>
              <button
                class="refresh-btn"
                id="refreshRates"
                title="Actualizar tasas"
              >
                <i class="fas fa-sync-alt"></i>
              </button>
            </div>

            <div class="calculator-body">
              <div class="currency-input-group">
                <label>Cantidad</label>
                <input
                  type="number"
                  id="amount"
                  placeholder="Ingresa cantidad"
                  value="100000"
                  min="0"
                  step="1000"
                />
              </div>

              <div class="currency-select-group">
                <div class="currency-from">
                  <label>De</label>
                  <select id="fromCurrency">
                    <option value="COP" selected>
                      🇨🇴 COP - Peso Colombiano
                    </option>
                    <option value="VES">🇻🇪 VES - Bolívar Venezolano</option>
                    <option value="USD">🇺🇸 USD - Dólar</option>
                    <option value="EUR">🇪🇺 EUR - Euro</option>
                  </select>
                </div>

                <button
                  class="swap-btn"
                  id="swapBtn"
                  title="Intercambiar monedas"
                >
                  <i class="fas fa-exchange-alt"></i>
                </button>

                <div class="currency-to">
                  <label>A</label>
                  <select id="toCurrency">
                    <option value="COP">🇨🇴 COP - Peso Colombiano</option>
                    <option value="VES">🇻🇪 VES - Bolívar Venezolano</option>
                    <option value="USD" selected>🇺🇸 USD - Dólar</option>
                    <option value="EUR">🇪🇺 EUR - Euro</option>
                  </select>
                </div>
              </div>

              <div class="result-display">
                <div class="result-amount" id="resultAmount">$0.00</div>
                <div class="exchange-rate" id="exchangeRate">
                  Cargando tasas...
                </div>
                <div class="last-update" id="lastUpdate"></div>
              </div>

              <button class="calculate-btn" id="calculateBtn">
                <i class="fas fa-calculator"></i> Calcular
              </button>

              <div class="info-note">
                <i class="fas fa-info-circle"></i>
                <p>Tasas actualizadas en tiempo real vía FastForex API</p>
              </div>

              <div
                class="loading-overlay"
                id="loadingOverlay"
                style="display: none"
              >
                <div class="spinner"></div>
                <p>Actualizando tasas...</p>
              </div>
            </div>
          </div>
          <script>
            // CALCULADORA - SOLO NETLIFY FUNCTIONS (no peticiones directas)

            let exchangeRates = {};
            let lastUpdateTime = null;

            const amountInput = document.getElementById("amount");
            const fromCurrencySelect = document.getElementById("fromCurrency");
            const toCurrencySelect = document.getElementById("toCurrency");
            const calculateBtn = document.getElementById("calculateBtn");
            const swapBtn = document.getElementById("swapBtn");
            const refreshBtn = document.getElementById("refreshRates");
            const resultAmount = document.getElementById("resultAmount");
            const exchangeRateDisplay = document.getElementById("exchangeRate");
            const lastUpdateDisplay = document.getElementById("lastUpdate");
            const loadingOverlay = document.getElementById("loadingOverlay");

            async function fetchExchangeRates() {
              try {
                loadingOverlay.style.display = "flex";

                console.log("🔄 Obteniendo tasas desde Netlify Function...");

                // Solo funciona cuando está desplegado en Netlify
                const response = await fetch("/.netlify/functions/get-rates");

                if (!response.ok) {
                  throw new Error(`Error: ${response.status}`);
                }

                const data = await response.json();
                console.log("📊 Respuesta:", data);

                if (data.success && data.rates) {
                  const usdRates = data.rates;

                  exchangeRates = {
                    USD: {
                      COP: parseFloat(usdRates.COP) || 3950,
                      VES: parseFloat(usdRates.VES) || 46.5,
                      EUR: parseFloat(usdRates.EUR) || 0.92,
                      USD: 1,
                    },
                    COP: {
                      USD: 1 / (parseFloat(usdRates.COP) || 3950),
                      VES:
                        (parseFloat(usdRates.VES) || 46.5) /
                        (parseFloat(usdRates.COP) || 3950),
                      EUR:
                        (parseFloat(usdRates.EUR) || 0.92) /
                        (parseFloat(usdRates.COP) || 3950),
                      COP: 1,
                    },
                    VES: {
                      USD: 1 / (parseFloat(usdRates.VES) || 46.5),
                      COP:
                        (parseFloat(usdRates.COP) || 3950) /
                        (parseFloat(usdRates.VES) || 46.5),
                      EUR:
                        (parseFloat(usdRates.EUR) || 0.92) /
                        (parseFloat(usdRates.VES) || 46.5),
                      VES: 1,
                    },
                    EUR: {
                      USD: 1 / (parseFloat(usdRates.EUR) || 0.92),
                      COP:
                        (parseFloat(usdRates.COP) || 3950) /
                        (parseFloat(usdRates.EUR) || 0.92),
                      VES:
                        (parseFloat(usdRates.VES) || 46.5) /
                        (parseFloat(usdRates.EUR) || 0.92),
                      EUR: 1,
                    },
                  };

                  lastUpdateTime = new Date();
                  updateLastUpdateDisplay();
                  calculateConversion();
                  console.log("✅ Tasas actualizadas");
                }
              } catch (error) {
                console.warn(
                  "⚠️ Error obteniendo tasas (normal en local):",
                  error.message
                );
                useFallbackRates();
              } finally {
                loadingOverlay.style.display = "none";
              }
            }

            function useFallbackRates() {
              // Tasas de respaldo para desarrollo local
              exchangeRates = {
                COP: { USD: 0.000253, EUR: 0.000233, VES: 0.0118, COP: 1 },
                USD: { COP: 3950, EUR: 0.92, VES: 46.5, USD: 1 },
                EUR: { COP: 4293, USD: 1.087, VES: 50.54, EUR: 1 },
                VES: { COP: 84.95, USD: 0.0215, EUR: 0.0198, VES: 1 },
              };

              lastUpdateDisplay.textContent =
                "📍 Modo local - Tasas aproximadas";
              lastUpdateDisplay.style.color = "#ff9800";
              calculateConversion();
            }

            function updateLastUpdateDisplay() {
              if (lastUpdateTime) {
                const timeString = lastUpdateTime.toLocaleTimeString("es-CO", {
                  hour: "2-digit",
                  minute: "2-digit",
                });
                lastUpdateDisplay.textContent = `✓ Actualizado: ${timeString}`;
                lastUpdateDisplay.style.color = "#4caf50";
              }
            }

            function formatNumber(num, currency) {
              try {
                return new Intl.NumberFormat("es-CO", {
                  style: "currency",
                  currency: currency,
                  minimumFractionDigits: 2,
                  maximumFractionDigits: 2,
                }).format(num);
              } catch (error) {
                return `${currency} ${num.toFixed(2)}`;
              }
            }

            function calculateConversion() {
              const amount = parseFloat(amountInput.value) || 0;
              const fromCurrency = fromCurrencySelect.value;
              const toCurrency = toCurrencySelect.value;

              if (amount <= 0) {
                resultAmount.textContent = formatNumber(0, toCurrency);
                exchangeRateDisplay.textContent = "Ingresa una cantidad válida";
                return;
              }

              if (!exchangeRates[fromCurrency]) {
                exchangeRateDisplay.textContent = "Cargando tasas...";
                return;
              }

              const rate = exchangeRates[fromCurrency][toCurrency];
              const result = amount * rate;

              resultAmount.textContent = formatNumber(result, toCurrency);
              const rateDisplay =
                rate < 0.01 ? rate.toFixed(6) : rate.toFixed(4);
              exchangeRateDisplay.textContent = `1 ${fromCurrency} = ${rateDisplay} ${toCurrency}`;
            }

            function swapCurrencies() {
              const tempFrom = fromCurrencySelect.value;
              fromCurrencySelect.value = toCurrencySelect.value;
              toCurrencySelect.value = tempFrom;
              calculateConversion();
            }

            calculateBtn.addEventListener("click", calculateConversion);
            swapBtn.addEventListener("click", swapCurrencies);
            refreshBtn.addEventListener("click", fetchExchangeRates);
            amountInput.addEventListener("input", calculateConversion);
            fromCurrencySelect.addEventListener("change", calculateConversion);
            toCurrencySelect.addEventListener("change", calculateConversion);

            // Iniciar con tasas de respaldo (funcionará cuando esté en Netlify)
            fetchExchangeRates();
          </script>
          <div class="info-box">
            <h3><i class="fas fa-lightbulb"></i> Consejos</h3>
            <ul class="tips-list">
              <li>Ten clara tu idea antes de enviar</li>
              <li>Adjunta referencias o imágenes</li>
              <li>Especifica cantidad exacta</li>
              <li>Indica tu presupuesto aproximado</li>
            </ul>
          </div>

          <div class="info-box highlight">
            <h3><i class="fas fa-question-circle"></i> ¿No sé qué elegir?</h3>
            <p>
              Visita nuestra página "¿Cómo Funciona?" para conocer las
              diferencias entre DTF y Sublimación
            </p>
            <a href="especificaciones.html" class="btn-small">Saber más</a>
          </div>
        </div>
      </div>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <h2>COPY<span>FAST&</span>PRINT</h2>
        <h5>Tu Solución Integral en Impresión y Personalización</h5>
      </div>
      <div class="social-networks">
        <a href="https://www.instagram.com/copyfastprint/" target="_blank"
          ><i class="fab fa-instagram"></i
        ></a>
        <a
          href="https://www.facebook.com/profile.php?id=61578120201237"
          target="_blank"
          ><i class="fab fa-facebook"></i
        ></a>
        <a href="https://co.pinterest.com/copyfastprint/" target="_blank"
          ><i class="fab fa-pinterest"></i
        ></a>
        <a href="https://www.tiktok.com/@copyfastprint" target="_blank"
          ><i class="fab fa-tiktok"></i
        ></a>
      </div>
    </footer>
    <a href="#" id="scroll-to-top" class="scroll-to-top">
      <i class="fas fa-chevron-up"></i>
    </a>
    <script src="js/scripts.js"></script>
    <script src="js/formulario-netlify.js"></script>
  </body>
</html>
